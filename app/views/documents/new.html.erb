<% uid = SecureRandom.hex(12) %>
<section class="uploader" id="uploader-<%= uid %>" data-uid="<%= uid %>">
  <%= s3_uploader_form(
    :post => property_template_documents_path(current_property, current_template),
    :key => document_upload_key,
    :as => "document[url]",
    :id => "fileupload-#{uid}",
    :html => { :multipart => params[:multipart] || false },
    :acl => current_template.aws_acl
  ) do %>
    <%= file_field_tag :file, :multiple => params[:multipart] || false %>
  <% end %>

  <script id="template-upload" type="text/x-tmpl">
  <div class="embedded upload">
    <div class="content">
      <h3>{%=o.name%}</h3>
      <div class="progress"><div class="bar" style="width: 0%"></div></div>
    </div>
    <% if params[:multipart] %>
      <p class="waiting">Waiting patiently in line ...</p>
    <% end %>
  </div>
  </script>
</section>
