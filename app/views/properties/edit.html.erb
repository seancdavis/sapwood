<%= page_header :title => current_property.title %>

<section class="body">
  <%= minimal_form_for current_property do |f| %>
    <div class="block aside">
      <h3>General</h3>
      <%= f.input :title, :autofocus => true, :label => 'Property Name' %>
      <h3>Config</h3>
      <% unless current_property.valid_templates? %>
        <span class="error">Your template config is invalid.</span>
      <% end %>
      <%= f.input :templates_raw, :label => 'Templates Config (JSON)',
                  :input_html => {
                    :class => ('error' unless current_property.valid_templates?)
                  } %>
      <%= f.input :collection_types_raw, :label => 'Collections Config (JSON)' %>
      <%= f.input :forms_raw, :label => 'Responses Config (JSON)' %>

      <h3>API Key</h3>
      <p>
        <code><%= current_property.api_key %></code>
      </p>
      <p><em>This property's API key is what enables you to retrieve data from
      the property.</em></p>

    <aside>
      <h3>Design</h3>
      <div class="input color">
        <span class="color-block"></span>
        <%= f.input :color, :label => false, :wrapper => false %>
      </div>
      <h3>Labels</h3>
      <%= f.simple_fields_for :labels do |ff| %>
        <% Property.labels.each do |label| %>
          <div class="label-input">
            <%= ff.input label.to_sym, :required => false,
                         :autofocus => (label == Property.labels.first),
                         :wrapper => false,
                         :input_html => {
                            :value => current_property.label(label) } %>
            <span class="switch">
              <input type="checkbox" value="1" id="label-visibility-<%= label %>"
                     class="label-visibility" data-label="<%= label %>"
                     <%= 'checked' if !current_property.label_hidden?(label) %>>
              <label for="label-visibility-<%= label %>"></label>
            </span>
          </div>
          <br>
        <% end %>
      <% end %>
      <br>
      <h3>Import Via CSV</h3>
      <p>Import via CSV is a new feature.
      <%= link_to 'Try it out.', property_import_path(current_property) %></p>
      <br><br><br>
      <%= f.input :hidden_labels, :as => :hidden %>
    </aside>
    </div>
    <%= f.submit 'Save Changes' %>
  <% end %>
</section>
